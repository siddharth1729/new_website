<!doctype html><html lang=en><head><meta charset=utf-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1" name=viewport><meta content=#ff7800 name=theme-color><link href=https://thelegion.tech/readings/comments/ rel=canonical><title>
     ActivityPub/​Fediverse comments demo - Siddharth Sabron
    
  </title><link href=https://thelegion.tech/style.css rel=stylesheet><link href=https://thelegion.tech/favicon.png rel=icon type=image/png><link href=https://thelegion.tech/apple-touch-icon.png rel=apple-touch-icon sizes=180x180><link href=https://mstdn.social/@Siddharth rel=me><meta content="Siddharth Sabron" property=og:site_name><meta content="
     ActivityPub/​Fediverse comments demo - Siddharth Sabron
    " property=og:title><meta content=https://thelegion.tech/readings/comments/ property=og:url><meta content="Siddharth is a computer science enthusiast, primarily interested in algorithms, design principles, databases, large-scale systems and distributed systems" property=og:description><meta content=https://thelegion.tech/card.png property=og:image><meta content=summary_large_image property=twitter:card><body><nav class=nav><div class=nav-container><a href=https://thelegion.tech>Siddharth Sabron</a><ul><li><a href=https://github.com/siddharth1729>Github</a><li><a href=/readings>Readings</a><li><a href=/blog>Blog</a><li><a href=/projects>Projets</a><li><a href=/tags>Tags</a><li><a href=https://thelegion.tech/atom.xml>Feed</a></ul></div></nav><div class=container><h1 class=heading>ActivityPub/​Fediverse comments demo</h1><section class="article comments" id=comments><h2>Comments</h2><p>Comment on this blog post by publicly replying to <a href=https://mstdn.social/@Siddharth/110896168682002971>this Mastodon post</a> using a Mastodon or other ActivityPub/Fediverse account. Known non-private replies are displayed below.<div id=comments-wrapper><p><small>Press the button below to load comments if they exist, if not, be the first!</small></p><noscript><p>Loading comments relies on JavaScript. Try enabling JavaScript and reloading, or visit <a href=https://mstdn.social/@Siddharth/110896168682002971>the original post</a> on Mastodon.</p></noscript><a class=inline-button onclick=loadComments()>Load comments…</a></div><script>function loadComments(){const a="mstdn.social";const b="mstdn.social";const c="Siddharth";const d="jTNX9pAV8XEPBby0cPWF6CmGY60kkIy4vidggfxXmoQ";const e="[]";const f="110896168682002971";const g=["image","gifv"];const h=`https://${a}/api/v1/statuses/${f}`;const i=new Headers();if(d!=""){i.append("Authorization","Bearer "+ d)};const j={method:"GET",headers:i,mode:"cors",cache:"default"};const k=new Request(h,j);const l=new Request(h+ "/context",j);let m=document.getElementById("comments-wrapper");fetch(k).then(n=>n.json()).then(n=>{fetch(l).then(o=>o.json()).then(o=>{let p=o['descendants'];if(p&&Array.isArray(p)&&p.length>0){m.innerHTML="";p.unshift(n);p.forEach(q=>{if(q.account.display_name.length>0){q.account.display_name=escapeHtml(q.account.display_name);q.account.display_name=emojify(q.account.display_name,q.account.emojis)}else{q.account.display_name=q.account.username};let r="";if(q.account.acct.includes("@")){r=q.account.acct.split("@")[1]}else{r=b};q.content=emojify(q.content,q.emojis);let s=document.createElement("source");s.setAttribute("srcset",escapeHtml(q.account.avatar));s.setAttribute("media","(prefers-reduced-motion: no-preference)");let t=document.createElement("img");t.className="avatar";t.setAttribute("src",escapeHtml(q.account.avatar_static));t.setAttribute("alt",`@${q.account.username}@${r} avatar`);let u=document.createElement("picture");u.appendChild(s);u.appendChild(t);let v=document.createElement("a");v.className="avatar-link";v.setAttribute("href",q.account.url);v.setAttribute("rel","external nofollow");v.setAttribute("title",`View profile at @${q.account.username}@${r}`);v.appendChild(u);let w=document.createElement("a");w.className="instance";w.setAttribute("href",q.account.url);w.setAttribute("title",`@${q.account.username}@${r}`);w.setAttribute("rel","external nofollow");w.textContent=r;let x=document.createElement("span");x.className="display";x.setAttribute("itemprop","author");x.setAttribute("itemtype","http://schema.org/Person");x.innerHTML=q.account.display_name;let y=document.createElement("header");y.className="author";y.appendChild(x);y.appendChild(w);let z=document.createElement("a");z.setAttribute("href",q.url);z.setAttribute("itemprop","url");z.setAttribute("title",`View comment at ${r}`);z.setAttribute("rel","external nofollow");z.textContent=new Date(q.created_at).toLocaleString('en-IE',{dateStyle:"long",timeStyle:"short"});let A=document.createElement("time");A.setAttribute("datetime",q.created_at);A.appendChild(z);if(q.edited_at!=null){A.classList.add("edited");A.setAttribute("title","Edited "+ new Date(q.edited_at).toLocaleString('en-IE',{dateStyle:"long",timeStyle:"short"}))};let B=document.createElement("main");B.setAttribute("itemprop","text");if(q.sensitive==true||q.spoiler_text!=""){let F=document.createElement("summary");if(q.spoiler_text==""){q.spoiler_text=="Sensitive"};F.innerHTML=q.spoiler_text;let G=document.createElement("details");G.appendChild(F);G.innerHTML+=q.content;B.appendChild(G)}else{B.innerHTML=q.content};let C=document.createElement("footer");if(q.reblogs_count>0){let F=document.createElement("span");F.className="boosts";F.setAttribute("title","Boosts");F.textContent=q.reblogs_count;C.appendChild(F)};if(q.favourites_count>0){let F=document.createElement("span");F.className="faves";F.setAttribute("title","Favorites");F.textContent=q.favourites_count;C.appendChild(F)};let D=document.createElement("article");D.id=`comment-${q.id}`;D.className="comment";D.setAttribute("itemprop","comment");D.setAttribute("itemtype","http://schema.org/Comment");D.appendChild(v);D.appendChild(y);D.appendChild(A);D.appendChild(B);let E=q.media_attachments;if(E&&Array.isArray(E)&&E.length>0){E.forEach(F=>{if(g.includes(F.type)){let G=document.createElement("a");G.className="card";G.setAttribute("href",F.url);G.setAttribute("rel","external nofollow");let H;switch(F.type){case "image":H=document.createElement("img");H.setAttribute("src",F.preview_url);if(F.description!=null){H.setAttribute("alt",F.description);H.setAttribute("title",F.description)};G.appendChild(H);break;case "gifv":H=document.createElement("video");H.setAttribute("src",F.url);H.setAttribute("autoplay","");H.setAttribute("playsinline","");H.setAttribute("loop","");if(F.description!=null){H.setAttribute("aria-title",F.description);H.setAttribute("title",F.description)};G.appendChild(H);break};D.appendChild(G)}})}else if(q.card!=null&&q.card.image!=null&&!q.card.url.startsWith("https:&#x2F;&#x2F;thelegion.tech")){let F=document.createElement("img");F.setAttribute("src",q.card.image);let G=document.createElement("h5");G.innerHTML=q.card.title;let H=document.createElement("p");H.innerHTML=q.card.description;let I=document.createElement("figcaption");I.appendChild(G);I.appendChild(H);let J=document.createElement("figure");J.appendChild(F);J.appendChild(I);let K=document.createElement("a");K.className="card";K.setAttribute("href",q.card.url);K.setAttribute("rel","external nofollow");K.appendChild(J);D.appendChild(K)};D.appendChild(C);if(q.account.acct==c){D.classList.add("op");v.classList.add("op");v.setAttribute("title","Blog post author; "+ v.getAttribute("title"));w.classList.add("op");w.setAttribute("title","Blog post author: "+ w.getAttribute("title"))}else if(e.includes(q.account.acct)){D.classList.add("verified");v.classList.add("verified");v.setAttribute("title",v.getAttribute("title")+ " (verified by site owner)");w.classList.add("verified");w.setAttribute("title",w.getAttribute("title")+ " (verified by site owner)")};m.innerHTML+=D.outerHTML})}})})}function emojify(a,b){let c=a;b.forEach(d=>{let e=document.createElement("picture");let f=document.createElement("source");f.setAttribute("srcset",escapeHtml(d.url));f.setAttribute("media","(prefers-reduced-motion: no-preference)");let g=document.createElement("img");g.className="emoji";g.setAttribute("src",escapeHtml(d.static_url));g.setAttribute("alt",`:${d.shortcode}:`);g.setAttribute("title",`:${d.shortcode}:`);g.setAttribute("width","20");g.setAttribute("height","20");e.appendChild(f);e.appendChild(g);c=c.replace(`:${d.shortcode}:`,e.outerHTML)});return c}function escapeHtml(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;")}</script></section><hr><p class=dialog-buttons><a class=inline-button href=#top>Go to top</a> <a href=https://git.exozy.me/daudix/duckquill/issues>File an issue</a></div><footer class=footer></footer>